# Anko Constraint Layout

This library adds missing support for Constraint Layout in Anko library.

## Usage

Constraint Layout is defined and added to other ViewGroups in the same way as any other view in Anko:
```kotlin
anyViewGroupLayout {
    constraintLayout {
        val name = textView("David")
        val surname = textView("Khol")
    
        constraints {
            name.connect(
                    STARTS of parentId with 16.dp,
                    TOPS of parentId with 16.dp
            )
            surname.connect(
                    TOP to BOTTOM of name,
                    STARTS of name
            )
        }
    }.lparams(matchParent, matchParent)
}
```
or it can be also created through `ViewManager`, `Context`, `Activity` as usual.

## Views positioning and ConstraintSet

To correctly position all views inside the Constraint Layout, we can set layout params to each child
it contains just as if we were using traditional xml definitions.

When defining layout programmatically, another approach is preferred. Instead of specifying layout
params for each child, we can specify relations between children through a `ConstraintSet`.
`ConstraintSet` adds extra helper methods to define constraints more expressively and intuitively.

You can create, define constraints into and then apply a Constraint Set to a Constraint Layout 
using `constraints` block:

```kotlin
constraintLayout {
    // view definitions
    
    constraints {
        // view constraint definitions
    }
}
```

Inside of the `constraints` block we can use various methods to define our layout:
 
### Connect

The most common thing to do with Constraint Layout is defining constraints. You can define a constraint
using `View.connect()` method.

```kotlin
constraints {
    name.connect(
            STARTS of parentId with 16.dp,
            TOPS of parentId with 16.dp
    )
    surname.connect(
            TOP to BOTTOM of name,
            STARTS of name
    )
    avatar.connect(
            HORIZONTAL of name,
            TOP to BOTTOM of name with 8.dp
    )
}
```

`View.connect()` method accepts variable amount of constraints. Each constraint is defined like this:

```SIDE to SIDE of VIEW [with MARGIN]``` 
* First `SIDE` defines side of the view we create constraints for. 
* Second `SIDE` defines side of the view we connect first view to. 
* `with MARGIN` clause is optional and defines from first view to the second one

Available sides are: `LEFT`, `RIGHT`, `TOP`, `BOTTOM`, `BASELINE`, `START`, `END`
 
To reduce boilerplate, instead of `START to START` you can just specify `STARTS` etc.
Additionally you can use `HORIZONTAL` to define `LEFTS` and `RIGHTS` at the same time and 
analogously `VERTICAL` to define `TOPS` and `BOTTOMS`.
Moreover, you can use `ALL` to define constraints for all four sides at the same time. 

### Chains
You can define [chains](https://developer.android.com/training/constraint-layout/index.html#constrain-chain)
with `chain()`, `chainSpread()`, `chainSpreadInside()` or `chainPacked()` methods like this: 

```kotlin
constraints {
    chainSpread(TOP of parentId, BOTTOM of parentId) {
        views(name, surname)
        weights(1f, 2f)
    }
}
```
You have to use either views() or viewIds() function to define (at least 2) elements of the chain.
When either `chain spread` or `chain spread inside` is used, you can also define weights to mimic 
functionality of `LinearLayout` and it's weights. To make weights work, you also have to set the 
view's height or width to `match_constraints` (0dp).

For more information about chains, have a look at [this great article](https://medium.com/@nomanr/constraintlayout-chains-4f3b58ea15bb) by Noman Rafique

### Dimensions and Ratios
TODO

```kotlin

```

### Guidelines
```kotlin
constraints {
    val leftGuide: Int = verticalGuidelineBegin(dip(16))
}
```

### Biases
TODO

### Placeholders
Not yet implemented.

### Percent dimensions
Not yet implemented.

[//]: # (
percent dimensions {
    android:layout_width="0dp"
    app:layout_constraintWidth_default="percent"
    app:layout_constraintWidth_percent=".4"
}
matchConstraintPercentHeight - only as layout parameter, not available in ConstraintSet
)

## IDs

Constraint Layout heavily depends on ids of its child views. 
For that reason, each child has to have defined an unique id.
We can predefine static ids for each view in `ids.xml` file to be generated by aapt and reference
them in code by `R.id.name_of_view_id`. This can be burdensome to do for every view we add.

This library automatically generates a **dynamic** unique id for each view that is added to the 
Constraint Layout and does not have a specified id.
This ensures positioning of views works correctly, but these ids do NOT get retained across 
configuration changes. That means any view that save its state into a bundle to be persisted across
configuration change will NOT be able to restore its state.
For numerous views such as `TextView`, `Button`, `ImageView`, etc. it is not a big deal because these
views usually don't modify their state based on user input. For other views such as `EditText`, 
`CheckBox`, `RadiButton`, `SeekBar`, etc. it is strongly advised to specify a static id so that
Android framework can restore the view's state automatically.

If you want to disable this functionality, you may set generateIds to false.
```kotlin
val view = context.constraintLayout {

    generateIds = false
    // added views here won't have generated ids
                 
    generateIds = true
    // added views here will once again have generated ids, unless an id has been assigned during their creation
}
```

Also, do NOT change ids of views after they have been added to the ConstraintLayout. ConstrainLayout
internally stores references to its views via views' id when they have been added. Changing view's id
and referencing it through its new id will not work and the view will most likely not even get displayed.

## Managing multiple Constraint Sets
TODO

## Sample

Sample app can be found in `app` module.

## Dependencies

Add this dependency to your project:
```groovy
implementation 'cz.ackee:anko-constraint-layout:0.4.1'
```

This library is still in development and your implementation might break when minor version gets bumped up. For now, backwards non-compatible changes happens about once every week. 

## References

For more information about Constraint Layout in general, check out these websites:
 * [constraintlayout.com](https://constraintlayout.com/)
 * [developer.android.com/constraint-layout](https://developer.android.com/training/constraint-layout/index.html)
 * [realm.io/advanced-constraintlayout](https://academy.realm.io/posts/360-andev-2017-nicolas-roard-advanced-constraintlayout/)
